(function(u,M){'object'==typeof exports&&'object'==typeof module?module.exports=M():'function'==typeof define&&define.amd?define([],M):'object'==typeof exports?exports.GSD=M():u.GSD=M()})(this,function(){return function(o){function u(S){if(M[S])return M[S].exports;var I=M[S]={exports:{},id:S,loaded:!1};return o[S].call(I.exports,I,I.exports,u),I.loaded=!0,I.exports}var M={};return u.m=o,u.c=M,u.p='',u(0)}([function(o,u,M){'use strict';o.exports.post=M(1),o.exports.gsd=M(15)},function(o,u,M){'use strict';function S(C,D,_,L,P){var O=_.length,W=[],G=[],T=Math.sign(_[1]-_[0]);-1===T&&(P[0]=_.length-1);for(var E=Math.abs(D-C)/2,F=(C+D)/2,Q=!1,K=P[0];!Q&&K<O&&0<=K;)Math.abs(_[K]-F)<=E?(W.push(_[K]),G.push(L[K]),K+=T):1===Math.sign(F-_[K])?K+=T:Q=!0;return P[0]=K,[W,G]}function I(C,D){var _=[],L=[],P,O,W=[C[0].x,D*C[0].width],G,T;for(P=0;P<C.length;P++)Math.abs(C[P].x-W[0])<D*C[P].width+W[1]?(_.push(C[P]),G=W[0]+W[1],C[P].x+D*C[P].width>G&&(G=C[P].x+D*C[P].width),T=W[0]-W[1],C[P].x-D*C[P].width<T&&(T=C[P].x-D*C[P].width),W=[(G+T)/2,Math.abs(G-T)/2]):(L.push({limits:W,group:_}),_=[C[P]],W=[C[P].x,D*C[P].width]);for(L.push({limits:W,group:_}),P=L.length-2;0<=P;P--)if(Math.abs(L[P].limits[0]-L[P+1].limits[0])<(L[P].limits[1]+L[P+1].limits[1])/2){for(O=0;O<L[P+1].group.length;O++)L[P].group.push(L[P+1].group[O]);G=L[P].limits[0]+L[P].limits[1],L[P+1].limits[0]+L[P+1].limits[1]>G&&(G=L[P+1].limits[0]+L[P+1].limits[1]),T=L[P].limits[0]-L[P].limits[1],L[P+1].limits[0]-L[P+1].limits[1]<T&&(T=L[P+1].limits[0]-L[P+1].limits[1]),L[P].limits=[(G+T)/2,Math.abs(G-T)/2],L.splice(P+1,1)}return L}var R=M(2);o.exports={optimizePeaks:function(D,_,L,P,O){var W,G,T=[0],E=I(D,P),F=[],Q=1;'gaussian'===O&&(Q=1.17741);var K,Z,$;for(W=0;W<E.length;W++){var ei=E[W].group;if(1<ei.length){if(K=S(E[W].limits[0]-E[W].limits[1],E[W].limits[0]+E[W].limits[1],_,L,T),5<K[0].length){Z=ei[0].width/1000,$=[3,100,Z,Z,Z,10*Z,10*Z,11,9,1];var oi=[];for('gaussian'===O?oi=R.optimizeGaussianSum(K,ei,$):'lorentzian'==O&&(oi=R.optimizeLorentzianSum(K,ei,$)),G=0;G<oi.length;G++)F.push({x:oi[G][0][0],y:oi[G][1][0],width:oi[G][2][0]*Q})}}else if(ei=ei[0],K=S(ei.x-P*ei.width,ei.x+P*ei.width,_,L,T),5<K[0].length){Z=ei.width/1000,$=[3,100,Z,Z,Z,10*Z,10*Z,11,9,1];var ti=[];'gaussian'===O?ti=R.optimizeSingleGaussian([K[0],K[1]],ei,$):'lorentzian'==O&&(ti=R.optimizeSingleLorentzian([K[0],K[1]],ei,$)),F.push({x:ti[0][0],y:ti[1][0],width:ti[2][0]*Q})}}return F},joinBroadPeaks:function(D,_){var L=_.width,P=[],O=0,W=0,G=1;for(let Q=D.length-1;0<=Q;Q--)D[Q].soft&&P.push(D.splice(Q,1)[0]);P.push({x:Number.MAX_VALUE});var T=[[P[0].x,P[0].y]],E=[0];for(let Q=1;Q<P.length;Q++)if(Math.abs(P[Q-1].x-P[Q].x)<L)T.push([P[Q].x,P[Q].y]),P[Q].y>O&&(O=P[Q].y,W=Q),E.push(Q),G++;else{if(2<G){var F=R.optimizeSingleLorentzian(T,{x:P[W].x,y:O,width:Math.abs(T[0][0]-T[T.length-1][0])});D.push({x:F[0][0],y:F[1][0],width:F[2][0],soft:!1})}else E.map(function(K){D.push(P[K])});T=[[P[Q].x,P[Q].y]],E=[Q],O=P[Q].y,W=Q,G=1}return D.sort(function(Q,K){return Q.x-K.x}),D}}},function(o,u,M){'use strict';function S(W,G,T){var F,Q,K,Z,E=G.length/3,$=W.rows,ei=O.zeros(W.length,1);for(Q=0;Q<E;Q++)for(Z=Math.pow(G[Q+2*E][0]/2,2),F=G[Q+E][0]*Z,K=0;K<$;K++)ei[K][0]+=F/(Math.pow(W[K][0]-G[Q][0],2)+Z);return ei}function I(W,G,T){var E=G[1][0]*Math.pow(G[2][0]/2,2),F=W.rows,Q=new O(W.rows,W.columns);for(var K=0;K<F;K++)Q[K][0]=E/(Math.pow(W[K][0]-G[0][0],2)+Math.pow(G[2][0]/2,2));return Q}function R(W,G,T){var E=G[2][0]*G[2][0]/2,F=W.rows,Q=new O(W.rows,W.columns);for(var K=0;K<F;K++)Q[K][0]=G[1][0]*Math.exp(-(W[K][0]-G[0][0])*(W[K][0]-G[0][0])/E);return Q}function C(W,G,T){T=T||{};var E=_(W,T.percentage||0);if(null===E||3>E[0].rows)return null;var F=E[0],Q=E[1],K=E[2],Z=F.rows,$=[Z/Math.sqrt(Q.dot(Q))],T=Object.create(T.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),ei=Math.abs(F[0][0]-F[1][0]),oi=new O([[-ei/10000],[-0.001],[-ei/10000]]),ti=new O([[G.x],[1],[G.width]]),ni=new O([[G.x-ei],[0.75],[G.width/4]]),si=new O([[G.x+ei],[1.25],[4*G.width]]),ri=L.optimize(I,ti,F,Q,$,oi,ni,si,[],T);return ri=ri.p,[ri[0],[ri[1][0]*K],ri[2]]}function D(W,G,T){T=T||{};var E=_(W,T.percentage||0);if(null===E||3>E[0].rows)return null;var F=E[0],Q=E[1],K=E[2],Z=F.rows,$=[Z/Math.sqrt(Q.dot(Q))],T=Object.create(T.LMOptions||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),ei=Math.abs(F[0][0]-F[1][0]),oi=new O([[-ei/10000],[-0.001],[-ei/10000]]),oi=new O([[-Math.abs(F[0][0]-F[1][0])/1000],[-0.001],[-G.width/1000]]),ti=new O([[G.x],[1],[G.width]]),ni=new O([[G.x-ei],[0.75],[G.width/4]]),si=new O([[G.x+ei],[1.25],[4*G.width]]),ri=L.optimize(R,ti,F,Q,$,oi,ni,si,[],T);return ri=ri.p,[ri[0],[ri[1][0]*K],ri[2]]}function _(W,G){var T=W.length,E=null,F=null,Q,K,Z=0,$;if(2==T){var ei=W[0].length;if(E=Array(ei),F=Array(ei),Q=W[0],K=W[1],'number'==typeof Q[0])for($=0;$<ei;$++)E[$]=Q[$],F[$]=K[$],K[$]>Z&&(Z=K[$]);else if('object'==typeof Q[0])for($=0;$<ei;$++)E[$]=Q[$][0],F[$]=K[$][0],K[$][0]>Z&&(Z=K[$][0])}else{var ei=T;for(E=Array(ei),F=Array(ei),$=0;$<ei;$++)E[$]=W[$][0],F[$]=W[$][1],F[$]>Z&&(Z=F[$])}for($=0;$<ei;$++)F[$]/=Z;if(G)for($=ei-1;0<=$;$--)F[$]<G&&(F.splice($,1),E.splice($,1));return 0<E.length?[new O([E]).transpose(),new O([F]).transpose(),Z]:null}var L=M(3),P=L.Matrix.algebra,O=M(5);o.exports.optimizeSingleLorentzian=C,o.exports.optimizeLorentzianSum=function(G,T,E){var F=_(G);if(null===F||3>F[0].rows)return null;var Q=F[0],K=F[1],Z=F[2],$=Q.rows,ei,oi=[$/P.sqrt(K.dot(K))],E=Object.create(E||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,1]),ti=T.length,ni=new O(3*ti,1),si=new O(3*ti,1),ri=new O(3*ti,1),li=new O(3*ti,1),ai=Math.abs(Q[0][0]-Q[1][0]);for(ei=0;ei<ti;ei++)ni[ei][0]=T[ei].x,ni[ei+ti][0]=1,ni[ei+2*ti][0]=T[ei].width,si[ei][0]=T[ei].x-ai,si[ei+ti][0]=0,si[ei+2*ti][0]=T[ei].width/4,ri[ei][0]=T[ei].x+ai,ri[ei+ti][0]=1.5,ri[ei+2*ti][0]=4*T[ei].width,li[ei][0]=-ai/1000,li[ei+ti][0]=-0.001,li[ei+2*ti][0]=-ai/1000;var li=-Math.abs(Q[0][0]-Q[1][0])/10000,mi=L.optimize(S,ni,Q,K,oi,li,si,ri,[],E);mi=mi.p;var ui=Array(ti);for(ei=0;ei<ti;ei++)ui[ei]=[mi[ei],[mi[ei+ti][0]*Z],mi[ei+2*ti]];return ui},o.exports.optimizeSingleGaussian=D,o.exports.optimizeGaussianSum=function(G,T,E){var F=_(G);if(null===F||3>F[0].rows)return null;var Q=F[0],K=F[1],Z=F[2],$=Q.rows,ei,oi=new O($,1),ti=$/P.sqrt(K.dot(K));for(ei=0;ei<$;ei++)oi[ei][0]=ti;var E=Object.create(E||[3,100,0.001,0.001,0.001,0.01,0.01,11,9,2]),ni=T.length,si=new O(3*ni,1),ri=new O(3*ni,1),li=new O(3*ni,1),ai=new O(3*ni,1),mi=Math.abs(Q[0][0]-Q[1][0]);for(ei=0;ei<ni;ei++)si[ei][0]=T[ei].x,si[ei+ni][0]=T[ei].y/Z,si[ei+2*ni][0]=T[ei].width,ri[ei][0]=T[ei].x-mi,ri[ei+ni][0]=0.8*T[ei].y/Z,ri[ei+2*ni][0]=T[ei].width/2,li[ei][0]=T[ei].x+mi,li[ei+ni][0]=1.2*T[ei].y/Z,li[ei+2*ni][0]=2*T[ei].width,ai[ei][0]=-mi/1000,ai[ei+ni][0]=-0.001,ai[ei+2*ni][0]=-mi/1000;var ui=L.optimize(S,si,Q,K,oi,ai,ri,li,[],E);ui=ui.p;var di=Array(ni);for(ei=0;ei<ni;ei++)di[ei]=[ui[ei],[ui[ei+ni][0]*Z],ui[ei+2*ni]];return di},o.exports.singleGaussian=R,o.exports.singleLorentzian=I,o.exports.optimizeGaussianTrain=function(G,T,E){var F=_(G);if(null===F||3>F[0].rows)return null;var Q=F[0],K=F[1],Z=F[2],$=0,ei=Q.length,oi,ti,ni,Z,si=[],ri;for(var li=0;li<T.length;li++){for(oi=T[li].x-4*T[li].width;Q[$++]<oi&&$<ei;);for(oi=T[li].x+4*T[li].width,ti=[],ni=[];Q[$]<=oi&&$<ei;)ti.push(Q[$][0]),ni.push(K[$][0]*Z),$++;ri=D([ti,ni],T[li],E),ri?si.push({x:ri[0][0],y:ri[1][0],width:ri[2][0],opt:!0}):si.push({x:T[li].x,y:T[li].y,width:T[li].width,opt:!1})}return si},o.exports.optimizeLorentzianTrain=function(G,T,E){var F=_(G);if(null===F||3>F[0].rows)return null;var Q=F[0],K=F[1],Z=F[2],$=0,ei=Q.length,oi,ti,ni,Z,si=[],ri;for(var li=0;li<T.length;li++){for(oi=T[li].x-4*T[li].width;Q[$++]<oi&&$<ei;);for(oi=T[li].x+4*T[li].width,ti=[],ni=[];Q[$]<=oi&&$<ei;)ti.push(Q[$][0]),ni.push(K[$][0]*Z),$++;ri=C([ti,ni],T[li],E),ri?si.push({x:ri[0][0],y:ri[1][0],width:ri[2][0],opt:!0}):si.push({x:T[li].x,y:T[li].y,width:T[li].width,opt:!1})}return si}},function(o,u,M){'use strict';o.exports=M(4),o.exports.Matrix=M(5),o.exports.Matrix.algebra=M(14)},function(o,u,M){var S=M(5),I=M(14);o.exports={optimize:function(R,C,D,_,L,P,O,W,G,T){var E=0,F=0;if('object'!=typeof C[0])for(var Q=0;Q<C.length;Q++)C[Q]=[C[Q]];var Q,K,Z=-50,$=C.length,ei=_.length,oi=S.zeros($,1),ti=S.zeros(ei,1),ni=0.01/Z,si=0.01/Z,ri=S.zeros(ei,$);if(D.length!=_.length){console.log('lm.m error: the length of t must equal the length of y_dat'),length_t=D.length,length_y_dat=_.length;var ni=0;return}L=L||Math.sqrt((ei-$+1)/I.multiply(I.transpose(_),_)),P=P||0.001,O=O||I.multiply(Math.abs(C),-100),W=W||I.multiply(Math.abs(C),100),G=G||1,T=T||[3,10*$,0.001,0.001,0.001,0.01,0.01,11,9,1];var li=T[0],ai=T[1],mi=T[2];T[3],T[4];var ui=T[5],di=T[6],pi=T[7],ci=T[8],ji=T[9];if(!P.length||1==P.length){var hi=Array($);for(var Q=0;Q<$;Q++)hi[Q]=[P];P=hi}var wi=[];for(Q=0;Q<P.length;Q++)0!=P[Q][0]&&wi.push(Q);var gi=wi.length,ki=!1,bi=null;if(!L.length||L.length<ei){var fi=I.multiply(S.ones(ei,1),L[0]);bi=I.dotMultiply(fi,fi)}else bi=I.dotMultiply(L,L);var zi=this.lm_matx(R,D,oi,ti,1,ri,C,_,bi,P,G),Mi=zi.JtWJ,Si=zi.JtWdy,ni=zi.Chi_sq,Ii=zi.y_hat,ri=zi.J;Math.max(Math.abs(Si))<mi&&(console.log(' *** Your Initial Guess is Extremely Close to Optimal ***'),console.log(' *** epsilon_1 = ',mi),ki=!0),1===ji?lambda=di:(lambda=di*Math.max(I.diag(Mi)),nu=2),si=ni;for(var Ri=null;!ki&&F<=ai;){F=F+1,Ri=1===ji?I.solve(I.add(Mi,I.multiply(I.diag(I.diag(Mi)),lambda)),Si):I.solve(I.add(Mi,I.multiply(S.eye($),lambda)),Si);var Vi=Array(wi.length);for(K=0;K<wi.length;K++)Vi[K]=Ri[wi[K]];var Ci=I.add(C,Vi);for(K=0;K<Ci.length;K++)Ci[K][0]=Math.min(Math.max(O[K][0],Ci[K][0]),W[K][0]);var qi=I.subtract(_,R(D,Ci,G)),Di=I.multiply(I.transpose(qi),I.dotMultiply(qi,bi));if(2==ji){var _i=I.multiply(I.transpose(Si),Ri),Ai=I.multiply(_i,I.inv(I.add(I.multiply(I.subtract(Di-ni),1/2)),I.multiply(_i,2)));Ri=I.multiply(Ai,Ri);for(var K=0;K<wi.length;K++)Vi[K]=Ri[wi[K]];Ci=I.add(C,Vi),Ci=I.min(I.max(O,Ci),W),qi=I.subtract(_,R(D,Ci,G)),Di=I.multiply(I.transpose(qi),mat.dotMultiply(qi,bi))}var Li=(ni-Di)/I.multiply(I.multiply(I.transpose(Ri),2),I.add(I.multiply(lambda,Ri),Si));Li>ui?(dX2=ni-si,si=ni,oi=C,ti=Ii,C=Ci,zi=this.lm_matx(R,D,oi,ti,dX2,ri,C,_,bi,P,G),Mi=zi.JtWJ,Si=zi.JtWdy,ni=zi.Chi_sq,Ii=zi.y_hat,ri=zi.J,1===ji?lambda=Math.max(lambda/ci,1e-7):2===ji?lambda=Math.max(lambda/(1+Ai),1e-7):3===ji?(lambda=I.multiply(Math.max(1/3,3^1-(2*Li-1)),lambda),nu=2):void 0):(ni=si,0==F%(2*$)&&(zi=this.lm_matx(R,D,oi,ti,-1,ri,C,_,bi,P,G),Mi=zi.JtWJ,Si=zi.JtWdy,dX2=zi.Chi_sq,Ii=zi.y_hat,ri=zi.J),1===ji?lambda=Math.min(lambda*pi,10000000):2===ji?lambda=lambda+Math.abs((Di-ni)/2/Ai):3===ji?(lambda=lambda*nu,nu=2*nu):void 0)}return bi=I.multiply(I.multiply(I.transpose(qi),qi),S.ones(ei,1)),bi.apply(function(Ji,Pi){bi[Ji][Pi]=(ei-gi+1)/bi[Ji][Pi]}),zi=this.lm_matx(R,D,oi,ti,-1,ri,C,_,bi,P,G),Mi=zi.JtWJ,Si=zi.JtWdy,ni=zi.Chi_sq,Ii=zi.y_hat,ri=zi.J,{p:C,X2:ni}},lm_FD_J:function(R,C,D,_,L,P){var O=_.length,W=D.length;L=L||I.multiply(S.ones(W,1),0.001);var G=D.clone(),T=new S(O,W),E=Array(W);for(var F=0;F<W;F++){if(E[F]=L[F]*(1+Math.abs(D[F][0])),D[F]=[G[F][0]+E[F]],0!=E[F])if(y1=R(C,D,P),0>L[F][0]){var Q=I.dotDivide(I.subtract(y1,_),E[F]);for(var K=0;K<O;K++)T[K][F]=Q[K][0]}else{D[F][0]=G[F][0]-E[F];var Q=I.dotDivide(I.subtract(y1,R(C,D,P)),2*E[F]);for(var K=0;K<O;K++)T[K][F]=Q[K][0]}D[F]=G[F]}return T},lm_Broyden_J:function(R,C,D,_,L){var P=I.subtract(_,R),O=I.transpose(P);return O.div(I.multiply(O,P)),D=I.add(D,I.multiply(I.subtract(L,I.add(C,I.multiply(D,P))),O)),D},lm_matx:function(R,C,D,_,L,P,O,W,G,T,E,F){W.length;var Q=O.length;T=T||0.001;var K=R(C,O,E);P=0==F%(2*Q)||0<L?this.lm_FD_J(R,C,O,K,T,E):this.lm_Broyden_J(D,_,P,O,K);var Z=I.subtract(W,K),$=I.multiply(I.transpose(Z),I.dotMultiply(Z,G)),ei=I.transpose(P),oi=I.multiply(ei,I.dotMultiply(P,I.multiply(G,S.ones(1,Q)))),ti=I.multiply(ei,I.dotMultiply(G,Z));return{JtWJ:oi,JtWdy:ti,Chi_sq:$,y_hat:K,J:P}}}},function(o,u,M){'use strict';o.exports=M(6),o.exports.Decompositions=o.exports.DC=M(7)},function(o,u){'use strict';function M(C){for(var D=0,_=C.length,L=Array(_);D<_;D++)L[D]=C[D];return L}function S(C,D){var L,P,_=0;if(Array.isArray(C)){if(P=D,L=P?M(C):C,C=L.length,D=L[0].length,'undefined'==typeof D)throw new TypeError('Data must be a 2D array');if(0<C&&0<D){for(;_<C;_++)if(L[_].length!==D)throw new RangeError('Inconsistent array dimensions');else P&&(L[_]=M(L[_]));}else throw new RangeError('Invalid dimensions: '+C+'x'+D)}else if('number'!=typeof C)throw new TypeError('Invalid arguments');else if(0<C&&0<D)for(L=Array(C);_<C;_++)L[_]=Array(D);else throw new RangeError('Invalid dimensions: '+C+'x'+D);return Object.defineProperty(L,'rows',{writable:!0,value:C}),Object.defineProperty(L,'columns',{writable:!0,value:D}),L.__proto__=S.prototype,L}var I=Array.prototype.splice,R=Array.prototype.concat;S.from1DArray=function(D,_,L){var P,O,W=0;if(P=D*_,P!==L.length)throw new RangeError('Data length does not match given dimensions');for(O=Array(D);W<D;W++)O[W]=L.slice(W*_,(W+1)*_);return new S(O)},S.rowVector=function(D){return new S([D])},S.columnVector=function(D){var _=D.length,L=Array(_);for(var P=0;P<_;P++)L[P]=[D[P]];return new S(L)},S.empty=function(D,_){return new S(D,_)},S.zeros=function(D,_){return S.empty(D,_).fill(0)},S.ones=function(D,_){return S.empty(D,_).fill(1)},S.rand=function(D,_){var L=S.empty(D,_);for(var P=0,O=L.rows;P<O;P++)for(var W=0,G=L.columns;W<G;W++)L[P][W]=Math.random();return L},S.eye=function(D){var _=S.zeros(D,D),L=_.rows;for(var P=0;P<L;P++)_[P][P]=1;return _},S.diag=function(D){var _=D.length,L=S.zeros(_,_);for(var P=0;P<_;P++)L[P][P]=D[P];return L},S.indices=function(D,_){var L=Array(_-D);for(var P=0;P<L.length;P++)L[P]=D++;return L},S.stack=function(D){var _,L,P;if(S.isMatrix(D)){var O=0,W=0;for(_=0;_<arguments.length;_++)O+=arguments[_].rows,arguments[_].columns>W&&(W=arguments[_].columns);var G=S.zeros(O,W),T=0;for(_=0;_<arguments.length;_++){var E=arguments[_];for(L=0;L<E.rows;L++){for(P=0;P<E.columns;P++)G[T][P]=E[L][P];T++}}return G}if(Array.isArray(D)){var F=S.empty(arguments.length,D.length);for(_=0;_<arguments.length;_++)F.setRow(_,arguments[_]);return F}},S.expand=function(D,_){var L=[];for(var P=0;P<_.length;P++)for(var O=0;O<_[P];O++)L.push(D[P]);return new S(L)},S.checkMatrix=function(D){if(!D)throw new TypeError('Argument has to be a matrix');return'Matrix'!==D.klass&&(D=new S(D)),D},S.isMatrix=function(D){return!!D&&'Matrix'===D.klass},Object.defineProperty(S.prototype,'klass',{get:function(){return'Matrix'}}),Object.defineProperty(S.prototype,'size',{get:function(){return this.rows*this.columns}}),S.prototype.checkRowIndex=function(D){if(0>D||D>this.rows-1)throw new RangeError('Row index out of range.')},S.prototype.checkColumnIndex=function(D){if(0>D||D>this.columns-1)throw new RangeError('Column index out of range.')},S.prototype.checkDimensions=function(D){if(this.rows!==D.rows||this.columns!==D.columns)throw new RangeError('Matrices dimensions must be equal.')},S.prototype.apply=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)D.call(this,P,O);return this},S.prototype.clone=function(){return new S(this.to2DArray())},S.prototype.to1DArray=function(){return R.apply([],this)},S.prototype.to2DArray=function(){var D=this.rows,_=Array(D);for(var L=0;L<D;L++)_[L]=M(this[L]);return _},S.prototype.isRowVector=function(){return 1===this.rows},S.prototype.isColumnVector=function(){return 1===this.columns},S.prototype.isVector=function(){return 1===this.rows||1===this.columns},S.prototype.isSquare=function(){return this.rows===this.columns},S.prototype.isSymmetric=function(){if(this.isSquare()){var D=this.rows;for(var _=0;_<D;_++)for(var L=0;L<=_;L++)if(this[_][L]!==this[L][_])return!1;return!0}return!1},S.prototype.set=function(D,_,L){return this[D][_]=L,this},S.prototype.get=function(D,_){return this[D][_]},S.prototype.fill=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]=D;return this},S.prototype.neg=function(){return this.mulS(-1)},S.prototype.add=function(D){return'number'==typeof D?this.addS(D):(D=S.checkMatrix(D),this.addM(D))},S.prototype.addS=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]+=D;return this},S.prototype.addM=function(D){this.checkDimensions(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]+=D[P][O];return this},S.prototype.sub=function(D){return'number'==typeof D?this.subS(D):(D=S.checkMatrix(D),this.subM(D))},S.prototype.subS=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]-=D;return this},S.prototype.subM=function(D){this.checkDimensions(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]-=D[P][O];return this},S.prototype.mul=function(D){return'number'==typeof D?this.mulS(D):(D=S.checkMatrix(D),this.mulM(D))},S.prototype.mulS=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]*=D;return this},S.prototype.mulM=function(D){this.checkDimensions(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]*=D[P][O];return this},S.prototype.div=function(D){return'number'==typeof D?this.divS(D):(D=S.checkMatrix(D),this.divM(D))},S.prototype.divS=function(D){var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]/=D;return this},S.prototype.divM=function(D){this.checkDimensions(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]/=D[P][O];return this},S.prototype.getRow=function(D){return this.checkRowIndex(D),M(this[D])},S.prototype.getRowVector=function(D){return S.rowVector(this.getRow(D))},S.prototype.setRow=function(D,_){if(this.checkRowIndex(D),S.isMatrix(_)&&(_=_.to1DArray()),_.length!==this.columns)throw new RangeError('Invalid row size');return this[D]=M(_),this},S.prototype.removeRow=function(D){if(this.checkRowIndex(D),1===this.rows)throw new RangeError('A matrix cannot have less than one row');return I.call(this,D,1),this.rows-=1,this},S.prototype.addRow=function(D,_){if('undefined'==typeof _&&(_=D,D=this.rows),0>D||D>this.rows)throw new RangeError('Row index out of range.');if(S.isMatrix(_)&&(_=_.to1DArray()),_.length!==this.columns)throw new RangeError('Invalid row size');return I.call(this,D,0,M(_)),this.rows+=1,this},S.prototype.swapRows=function(D,_){this.checkRowIndex(D),this.checkRowIndex(_);var L=this[D];return this[D]=this[_],this[_]=L,this},S.prototype.getColumn=function(D){this.checkColumnIndex(D);var _=this.rows,L=Array(_);for(var P=0;P<_;P++)L[P]=this[P][D];return L},S.prototype.getColumnVector=function(D){return S.columnVector(this.getColumn(D))},S.prototype.setColumn=function(D,_){this.checkColumnIndex(D),S.isMatrix(_)&&(_=_.to1DArray());var L=this.rows;if(_.length!==L)throw new RangeError('Invalid column size');for(var P=0;P<L;P++)this[P][D]=_[P];return this},S.prototype.removeColumn=function(D){if(this.checkColumnIndex(D),1===this.columns)throw new RangeError('A matrix cannot have less than one column');for(var _=0,L=this.rows;_<L;_++)this[_].splice(D,1);return this.columns-=1,this},S.prototype.addColumn=function(D,_){if('undefined'==typeof _&&(_=D,D=this.columns),0>D||D>this.columns)throw new RangeError('Column index out of range.');S.isMatrix(_)&&(_=_.to1DArray());var L=this.rows;if(_.length!==L)throw new RangeError('Invalid column size');for(var P=0;P<L;P++)this[P].splice(D,0,_[P]);return this.columns+=1,this},S.prototype.swapColumns=function(D,_){this.checkRowIndex(D),this.checkRowIndex(_);var P,O,L=this.rows;for(var W=0;W<L;W++)O=this[W],P=O[D],O[D]=O[_],O[_]=P;return this},S.prototype.checkRowVector=function(D){if(S.isMatrix(D)&&(D=D.to1DArray()),D.length!==this.columns)throw new RangeError('vector size must be the same as the number of columns');return D},S.prototype.checkColumnVector=function(D){if(S.isMatrix(D)&&(D=D.to1DArray()),D.length!==this.rows)throw new RangeError('vector size must be the same as the number of rows');return D},S.prototype.addRowVector=function(D){D=this.checkRowVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]+=D[O];return this},S.prototype.subRowVector=function(D){D=this.checkRowVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]-=D[O];return this},S.prototype.mulRowVector=function(D){D=this.checkRowVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]*=D[O];return this},S.prototype.divRowVector=function(D){D=this.checkRowVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]/=D[O];return this},S.prototype.addColumnVector=function(D){D=this.checkColumnVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]+=D[P];return this},S.prototype.subColumnVector=function(D){D=this.checkColumnVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]-=D[P];return this},S.prototype.mulColumnVector=function(D){D=this.checkColumnVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]*=D[P];return this},S.prototype.divColumnVector=function(D){D=this.checkColumnVector(D);var _=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]/=D[P];return this},S.prototype.mulRow=function(D,_){this.checkRowIndex(D);for(var L=0,P=this.columns;L<P;L++)this[D][L]*=_;return this},S.prototype.mulColumn=function(D,_){this.checkColumnIndex(D);for(var L=0,P=this.rows;L<P;L++)this[L][D]*=_},S.prototype.max=function(){var D=-(1/0),_=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]>D&&(D=this[P][O]);return D},S.prototype.maxIndex=function(){var D=-(1/0),_={},L=this.rows,P=this.columns;for(var O=0;O<L;O++)for(var W=0;W<P;W++)this[O][W]>D&&(D=this[O][W],_.row=O,_.column=W);return _},S.prototype.min=function(){var D=1/0,_=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)this[P][O]<D&&(D=this[P][O]);return D},S.prototype.minIndex=function(){var D=1/0,_={},L=this.rows,P=this.columns;for(var O=0;O<L;O++)for(var W=0;W<P;W++)this[O][W]<D&&(D=this[O][W],_.row=O,_.column=W);return _},S.prototype.maxRow=function(D){this.checkRowIndex(D);var _=-(1/0);for(var L=0,P=this.columns;L<P;L++)this[D][L]>_&&(_=this[D][L]);return _},S.prototype.maxRowIndex=function(D){this.checkRowIndex(D);var _=-(1/0),L={row:D};for(var P=0,O=this.columns;P<O;P++)this[D][P]>_&&(_=this[D][P],L.column=P);return L},S.prototype.minRow=function(D){this.checkRowIndex(D);var _=1/0;for(var L=0,P=this.columns;L<P;L++)this[D][L]<_&&(_=this[D][L]);return _},S.prototype.minRowIndex=function(D){this.checkRowIndex(D);var _=1/0,L={row:D,column:0};for(var P=0,O=this.columns;P<O;P++)this[D][P]<_&&(_=this[D][P],L.column=P);return L},S.prototype.maxColumn=function(D){this.checkColumnIndex(D);var _=-(1/0);for(var L=0,P=this.rows;L<P;L++)this[L][D]>_&&(_=this[L][D]);return _},S.prototype.maxColumnIndex=function(D){this.checkColumnIndex(D);var _=-(1/0),L={row:0,column:D};for(var P=0,O=this.rows;P<O;P++)this[P][D]>_&&(_=this[P][D],L.row=P);return L},S.prototype.minColumn=function(D){this.checkColumnIndex(D);var _=1/0;for(var L=0,P=this.rows;L<P;L++)this[L][D]<_&&(_=this[L][D]);return _},S.prototype.minColumnIndex=function(D){this.checkColumnIndex(D);var _=1/0,L={row:0,column:D};for(var P=0,O=this.rows;P<O;P++)this[P][D]<_&&(_=this[P][D],L.row=P);return L},S.prototype.diag=function(){if(!this.isSquare())throw new TypeError('Only square matrices have a diagonal.');var C=Array(this.rows);for(var D=0,_=this.rows;D<_;D++)C[D]=this[D][D];return C},S.prototype.sum=function(){var D=0,_=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)D+=this[P][O];return D},S.prototype.mean=function(){return this.sum()/this.size},S.prototype.prod=function(){var C=1,D=this.rows,_=this.columns;for(var L=0;L<D;L++)for(var P=0;P<_;P++)C*=this[L][P];return C},S.prototype.cumulativeSum=function(){var D=0,_=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)D+=this[P][O],this[P][O]=D;return this},S.prototype.dot=function(D){if(this.size!==D.size)throw new RangeError('vectors do not have the same size');var _=this.to1DArray(),L=D.to1DArray(),C=0,P=_.length;for(var O=0;O<P;O++)C+=_[O]*L[O];return C},S.prototype.mmul=function(D){if(!S.isMatrix(D))throw new TypeError('parameter "other" must be a matrix');this.columns!==D.rows&&console.warn('Number of columns of left matrix are not equal to number of rows of right matrix.');var _=this.rows,L=this.columns,P=D.columns,O=new S(_,P),W=Array(L),G,T,E;for(T=0;T<P;T++){for(E=0;E<L;E++)W[E]=D[E][T];for(G=0;G<_;G++){var F=this[G],Q=0;for(E=0;E<L;E++)Q+=F[E]*W[E];O[G][T]=Q}}return O},S.prototype.sortRows=function(D){for(var _=0,L=this.rows;_<L;_++)this[_].sort(D);return this},S.prototype.sortColumns=function(D){for(var _=0,L=this.columns;_<L;_++)this.setColumn(_,this.getColumn(_).sort(D));return this},S.prototype.transpose=function(){var D=new S(this.columns,this.rows),_=this.rows,L=this.columns;for(var P=0;P<_;P++)for(var O=0;O<L;O++)D[O][P]=this[P][O];return D},S.prototype.subMatrix=function(D,_,L,P){if(D>_||L>P||0>D||D>=this.rows||0>_||_>=this.rows||0>L||L>=this.columns||0>P||P>=this.columns)throw new RangeError('Argument out of range');var O=new S(_-D+1,P-L+1);for(var W=D;W<=_;W++)for(var G=L;G<=P;G++)O[W-D][G-L]=this[W][G];return O},S.prototype.subMatrixRow=function(D,_,L){if('undefined'==typeof _?(_=0,L=this.columns-1):'undefined'==typeof L&&(L=this.columns-1),_>L||0>_||_>=this.columns||0>L||L>=this.columns)throw new RangeError('Argument out of range.');var P=D.length,O=this.rows,W=new S(P,L-_+1);for(var G=0;G<P;G++)for(var T=_;T<=L;T++){if(0>D[G]||D[G]>=O)throw new RangeError('Argument out of range.');W[G][T-_]=this[D[G]][T]}return W},S.prototype.subMatrixColumn=function(D,_,L){if('undefined'==typeof _?(_=0,L=this.rows-1):'undefined'==typeof L&&(L=this.rows-1),_>L||0>_||_>=this.rows||0>L||L>=this.rows)throw new RangeError('Argument out of range.');var P=D.length,O=this.columns,W=new S(L-_+1,P);for(var G=0;G<P;G++)for(var T=_;T<=L;T++){if(0>D[G]||D[G]>=O)throw new RangeError('Argument out of range.');W[T-_][G]=this[T][D[G]]}return W},S.prototype.trace=function(){if(!this.isSquare())throw new TypeError('The matrix is not square');for(var C=0,D=0,_=this.rows;D<_;D++)C+=this[D][D];return C},S.prototype.abs=function(){var D=this.rows,_=this.columns;for(var L=0;L<D;L++)for(var P=0;P<_;P++)this[L][P]=Math.abs(this[L][P])},o.exports=S},function(o,u,M){'use strict';function S(O){return I(O,R.eye(O.rows))}function I(O,W){return O.isSquare()?new _(O).solve(W):new L(O).solve(W)}var R=M(6),C=M(8),D=M(10),_=M(11),L=M(12),P=M(13);R.prototype.inverse=function(){return S(this)},R.prototype.solve=function(O){return I(this,O)},o.exports={SingularValueDecomposition:C,SVD:C,EigenvalueDecomposition:D,EVD:D,LuDecomposition:_,LU:_,QrDecomposition:L,QR:L,CholeskyDecomposition:P,CHO:P,inverse:S,solve:I}},function(o,u,M){'use strict';function S(C,D){if(!(this instanceof S))return new S(C,D);C=I.checkMatrix(C),D=D||{};var _=C.clone(),L=C.rows,P=C.columns,O=Math.min(L,P),W=!0,G=!0;!1===D.computeLeftSingularVectors&&(W=!1),!1===D.computeRightSingularVectors&&(G=!1);var T=!0===D.autoTranspose,E=!1;if(L<P)if(!T)console.warn('Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose');else{_=_.transpose(),L=_.rows,P=_.columns,E=!0;var F=W;W=G,G=F}var ni,si,ri,li,ai,mi,ui,di,pi,ci,ji,hi,wi,gi,ki,bi,fi,zi,Mi,Si,Ii,Q=Array(Math.min(L+1,P)),K=I.zeros(L,O),Z=I.zeros(P,P),$=Array(P),ei=Array(L),oi=Math.min(L-1,P),ti=Math.max(0,Math.min(P-2,L));for(ri=0,ci=Math.max(oi,ti);ri<ci;ri++){if(ri<oi){for(Q[ri]=0,ni=ri;ni<L;ni++)Q[ri]=R(Q[ri],_[ni][ri]);if(0!==Q[ri]){for(0>_[ri][ri]&&(Q[ri]=-Q[ri]),ni=ri;ni<L;ni++)_[ni][ri]/=Q[ri];_[ri][ri]+=1}Q[ri]=-Q[ri]}for(si=ri+1;si<P;si++){if(ri<oi&&0!==Q[ri]){for(ai=0,ni=ri;ni<L;ni++)ai+=_[ni][ri]*_[ni][si];for(ai=-ai/_[ri][ri],ni=ri;ni<L;ni++)_[ni][si]+=ai*_[ni][ri]}$[si]=_[ri][si]}if(W&&ri<oi)for(ni=ri;ni<L;ni++)K[ni][ri]=_[ni][ri];if(ri<ti){for($[ri]=0,ni=ri+1;ni<P;ni++)$[ri]=R($[ri],$[ni]);if(0!==$[ri]){for(0>$[ri+1]&&($[ri]=-$[ri]),ni=ri+1;ni<P;ni++)$[ni]/=$[ri];$[ri+1]+=1}if($[ri]=-$[ri],ri+1<L&&0!==$[ri]){for(ni=ri+1;ni<L;ni++)ei[ni]=0;for(si=ri+1;si<P;si++)for(ni=ri+1;ni<L;ni++)ei[ni]+=$[si]*_[ni][si];for(si=ri+1;si<P;si++)for(ai=-$[si]/$[ri+1],ni=ri+1;ni<L;ni++)_[ni][si]+=ai*ei[ni]}if(G)for(ni=ri+1;ni<P;ni++)Z[ni][ri]=$[ni]}}if(li=Math.min(P,L+1),oi<P&&(Q[oi]=_[oi][oi]),L<li&&(Q[li-1]=0),ti+1<li&&($[ti]=_[ti][li-1]),$[li-1]=0,W){for(si=oi;si<O;si++){for(ni=0;ni<L;ni++)K[ni][si]=0;K[si][si]=1}for(ri=oi-1;0<=ri;ri--)if(0!==Q[ri]){for(si=ri+1;si<O;si++){for(ai=0,ni=ri;ni<L;ni++)ai+=K[ni][ri]*K[ni][si];for(ai=-ai/K[ri][ri],ni=ri;ni<L;ni++)K[ni][si]+=ai*K[ni][ri]}for(ni=ri;ni<L;ni++)K[ni][ri]=-K[ni][ri];for(K[ri][ri]=1+K[ri][ri],ni=0;ni<ri-1;ni++)K[ni][ri]=0}else{for(ni=0;ni<L;ni++)K[ni][ri]=0;K[ri][ri]=1}}if(G)for(ri=P-1;0<=ri;ri--){if(ri<ti&&0!==$[ri])for(si=ri+1;si<P;si++){for(ai=0,ni=ri+1;ni<P;ni++)ai+=Z[ni][ri]*Z[ni][si];for(ai=-ai/Z[ri+1][ri],ni=ri+1;ni<P;ni++)Z[ni][si]+=ai*Z[ni][ri]}for(ni=0;ni<P;ni++)Z[ni][ri]=0;Z[ri][ri]=1}for(var Ri=li-1,Vi=0,Ci=Math.pow(2,-52);0<li;){for(ri=li-2;-1<=ri&&-1!==ri;ri--)if(Math.abs($[ri])<=Ci*(Math.abs(Q[ri])+Math.abs(Q[ri+1]))){$[ri]=0;break}if(ri===li-2)ji=4;else{for(mi=li-1;mi>=ri&&mi!==ri;mi--)if(ai=(mi===li?0:Math.abs($[mi]))+(mi===ri+1?0:Math.abs($[mi-1])),Math.abs(Q[mi])<=Ci*ai){Q[mi]=0;break}mi===ri?ji=3:mi===li-1?ji=1:(ji=2,ri=mi)}switch(ri++,ji){case 1:{for(ui=$[li-2],$[li-2]=0,si=li-2;si>=ri;si--)if(ai=R(Q[si],ui),di=Q[si]/ai,pi=ui/ai,Q[si]=ai,si!==ri&&(ui=-pi*$[si-1],$[si-1]=di*$[si-1]),G)for(ni=0;ni<P;ni++)ai=di*Z[ni][si]+pi*Z[ni][li-1],Z[ni][li-1]=-pi*Z[ni][si]+di*Z[ni][li-1],Z[ni][si]=ai;break}case 2:{for(ui=$[ri-1],$[ri-1]=0,si=ri;si<li;si++)if(ai=R(Q[si],ui),di=Q[si]/ai,pi=ui/ai,Q[si]=ai,ui=-pi*$[si],$[si]=di*$[si],W)for(ni=0;ni<L;ni++)ai=di*K[ni][si]+pi*K[ni][ri-1],K[ni][ri-1]=-pi*K[ni][si]+di*K[ni][ri-1],K[ni][si]=ai;break}case 3:{for(hi=Math.max(Math.max(Math.max(Math.max(Math.abs(Q[li-1]),Math.abs(Q[li-2])),Math.abs($[li-2])),Math.abs(Q[ri])),Math.abs($[ri])),wi=Q[li-1]/hi,gi=Q[li-2]/hi,ki=$[li-2]/hi,bi=Q[ri]/hi,fi=$[ri]/hi,zi=((gi+wi)*(gi-wi)+ki*ki)/2,Mi=wi*ki*(wi*ki),Si=0,(0!==zi||0!==Mi)&&(Si=Math.sqrt(zi*zi+Mi),0>zi&&(Si=-Si),Si=Mi/(zi+Si)),ui=(bi+wi)*(bi-wi)+Si,Ii=bi*fi,si=ri;si<li-1;si++){if(ai=R(ui,Ii),di=ui/ai,pi=Ii/ai,si!==ri&&($[si-1]=ai),ui=di*Q[si]+pi*$[si],$[si]=di*$[si]-pi*Q[si],Ii=pi*Q[si+1],Q[si+1]=di*Q[si+1],G)for(ni=0;ni<P;ni++)ai=di*Z[ni][si]+pi*Z[ni][si+1],Z[ni][si+1]=-pi*Z[ni][si]+di*Z[ni][si+1],Z[ni][si]=ai;if(ai=R(ui,Ii),di=ui/ai,pi=Ii/ai,Q[si]=ai,ui=di*$[si]+pi*Q[si+1],Q[si+1]=-pi*$[si]+di*Q[si+1],Ii=pi*$[si+1],$[si+1]=di*$[si+1],W&&si<L-1)for(ni=0;ni<L;ni++)ai=di*K[ni][si]+pi*K[ni][si+1],K[ni][si+1]=-pi*K[ni][si]+di*K[ni][si+1],K[ni][si]=ai}$[li-2]=ui,Vi=Vi+1;break}case 4:{if(0>=Q[ri]&&(Q[ri]=0>Q[ri]?-Q[ri]:0,G))for(ni=0;ni<=Ri;ni++)Z[ni][ri]=-Z[ni][ri];for(;ri<Ri&&!(Q[ri]>=Q[ri+1]);){if(ai=Q[ri],Q[ri]=Q[ri+1],Q[ri+1]=ai,G&&ri<P-1)for(ni=0;ni<P;ni++)ai=Z[ni][ri+1],Z[ni][ri+1]=Z[ni][ri],Z[ni][ri]=ai;if(W&&ri<L-1)for(ni=0;ni<L;ni++)ai=K[ni][ri+1],K[ni][ri+1]=K[ni][ri],K[ni][ri]=ai;ri++}Vi=0,li--;break}}}if(E){var qi=Z;Z=K,K=qi}this.m=L,this.n=P,this.s=Q,this.U=K,this.V=Z}var I=M(6),R=M(9).hypotenuse;S.prototype={get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]},get norm2(){return this.s[0]},get rank(){var C=Math.pow(2,-52),D=Math.max(this.m,this.n)*this.s[0]*C,_=0,L=this.s;for(var P=0,O=L.length;P<O;P++)L[P]>D&&_++;return _},get diagonal(){return this.s},get threshold(){return Math.pow(2,-52)/2*Math.max(this.m,this.n)*this.s[0]},get leftSingularVectors(){return this.U},get rightSingularVectors(){return this.V},get diagonalMatrix(){return I.diag(this.s)},solve:function(C){var P,D=this.threshold,_=this.s.length,L=I.zeros(_,_);for(P=0;P<_;P++)L[P][P]=Math.abs(this.s[P])<=D?0:1/this.s[P];var E,F,Q,O=this.V.mmul(L),W=this.V.rows,G=this.U.rows,T=I.zeros(W,G);for(P=0;P<W;P++)for(E=0;E<G;E++){for(Q=0,F=0;F<_;F++)Q+=O[P][F]*this.U[E][F];T[P][E]=Q}return T.mmul(C)},solveForDiagonal:function(C){return this.solve(I.diag(C))},inverse:function(){var P,O,C=this.threshold,D=this.V.rows,_=this.V.columns,L=new I(D,this.s.length);for(P=0;P<D;P++)for(O=0;O<_;O++)L[P][O]=Math.abs(this.s[O])>C?this.V[P][O]/this.s[O]:0;var E,F,W=this.U.rows,G=this.U.columns,T=new I(D,W);for(P=0;P<D;P++)for(O=0;O<W;O++){for(F=0,E=0;E<G;E++)F+=L[P][E]*this.U[O][E];T[P][O]=F}return T}},o.exports=S},function(o,u){'use strict';u.hypotenuse=function(S,I){var R;return Math.abs(S)>Math.abs(I)?(R=I/S,Math.abs(S)*Math.sqrt(1+R*R)):0===I?0:(R=S/I,Math.abs(I)*Math.sqrt(1+R*R))}},function(o,u,M){'use strict';function S(O){if(!(this instanceof S))return new S(O);if(O=L.checkMatrix(O),!O.isSquare())throw new Error('Matrix is not a square matrix');var Q,K,W=O.columns,G=L.zeros(W,W),T=Array(W),E=Array(W),F=O;if(O.isSymmetric()){for(Q=0;Q<W;Q++)for(K=0;K<W;K++)G[Q][K]=F[Q][K];I(W,E,T,G),R(W,E,T,G)}else{var Z=L.zeros(W,W),$=Array(W);for(K=0;K<W;K++)for(Q=0;Q<W;Q++)Z[Q][K]=F[Q][K];C(W,Z,$,G),D(W,E,T,G,Z)}this.n=W,this.e=E,this.d=T,this.V=G}function I(O,W,G,T){var E,F,Q,K,Z,$,ei,oi;for(Z=0;Z<O;Z++)G[Z]=T[O-1][Z];for(K=O-1;0<K;K--){for(oi=0,Q=0,$=0;$<K;$++)oi=oi+Math.abs(G[$]);if(0===oi)for(W[K]=G[K-1],Z=0;Z<K;Z++)G[Z]=T[K-1][Z],T[K][Z]=0,T[Z][K]=0;else{for($=0;$<K;$++)G[$]/=oi,Q+=G[$]*G[$];for(E=G[K-1],F=Math.sqrt(Q),0<E&&(F=-F),W[K]=oi*F,Q=Q-E*F,G[K-1]=E-F,Z=0;Z<K;Z++)W[Z]=0;for(Z=0;Z<K;Z++){for(E=G[Z],T[Z][K]=E,F=W[Z]+T[Z][Z]*E,$=Z+1;$<=K-1;$++)F+=T[$][Z]*G[$],W[$]+=T[$][Z]*E;W[Z]=F}for(E=0,Z=0;Z<K;Z++)W[Z]/=Q,E+=W[Z]*G[Z];for(ei=E/(Q+Q),Z=0;Z<K;Z++)W[Z]-=ei*G[Z];for(Z=0;Z<K;Z++){for(E=G[Z],F=W[Z],$=Z;$<=K-1;$++)T[$][Z]-=E*W[$]+F*G[$];G[Z]=T[K-1][Z],T[K][Z]=0}}G[K]=Q}for(K=0;K<O-1;K++){if(T[O-1][K]=T[K][K],T[K][K]=1,Q=G[K+1],0!==Q){for($=0;$<=K;$++)G[$]=T[$][K+1]/Q;for(Z=0;Z<=K;Z++){for(F=0,$=0;$<=K;$++)F+=T[$][K+1]*T[$][Z];for($=0;$<=K;$++)T[$][Z]-=F*G[$]}}for($=0;$<=K;$++)T[$][K+1]=0}for(Z=0;Z<O;Z++)G[Z]=T[O-1][Z],T[O-1][Z]=0;T[O-1][O-1]=1,W[0]=0}function R(O,W,G,T){var E,F,Q,K,Z,$,ei,oi,ti,ni,si,ri,li,ai,mi,ui,di;for(Q=1;Q<O;Q++)W[Q-1]=W[Q];W[O-1]=0;var pi=0,ci=0,ji=Math.pow(2,-52);for($=0;$<O;$++){for(ci=Math.max(ci,Math.abs(G[$])+Math.abs(W[$])),ei=$;ei<O&&!(Math.abs(W[ei])<=ji*ci);)ei++;if(ei>$){di=0;do{for(di=di+1,E=G[$],oi=(G[$+1]-E)/(2*W[$]),ti=P(oi,1),0>oi&&(ti=-ti),G[$]=W[$]/(oi+ti),G[$+1]=W[$]*(oi+ti),ni=G[$+1],F=E-G[$],Q=$+2;Q<O;Q++)G[Q]-=F;for(pi=pi+F,oi=G[ei],si=1,ri=si,li=si,ai=W[$+1],mi=0,ui=0,Q=ei-1;Q>=$;Q--)for(li=ri,ri=si,ui=mi,E=si*W[Q],F=si*oi,ti=P(oi,W[Q]),W[Q+1]=mi*ti,mi=W[Q]/ti,si=oi/ti,oi=si*G[Q]-mi*E,G[Q+1]=F+mi*(si*E+mi*G[Q]),Z=0;Z<O;Z++)F=T[Z][Q+1],T[Z][Q+1]=mi*T[Z][Q]+si*F,T[Z][Q]=si*T[Z][Q]-mi*F;oi=-mi*ui*li*ai*W[$]/ni,W[$]=mi*oi,G[$]=si*oi}while(Math.abs(W[$])>ji*ci)}G[$]=G[$]+pi,W[$]=0}for(Q=0;Q<O-1;Q++){for(Z=Q,oi=G[Q],K=Q+1;K<O;K++)G[K]<oi&&(Z=K,oi=G[K]);if(Z!==Q)for(G[Z]=G[Q],G[Q]=oi,K=0;K<O;K++)oi=T[K][Q],T[K][Q]=T[K][Z],T[K][Z]=oi}}function C(O,W,G,T){var Q,K,Z,$,ei,oi,ti,E=0,F=O-1;for(oi=E+1;oi<=F-1;oi++){for(ti=0,$=oi;$<=F;$++)ti=ti+Math.abs(W[$][oi-1]);if(0!==ti){for(Z=0,$=F;$>=oi;$--)G[$]=W[$][oi-1]/ti,Z+=G[$]*G[$];for(K=Math.sqrt(Z),0<G[oi]&&(K=-K),Z=Z-G[oi]*K,G[oi]=G[oi]-K,ei=oi;ei<O;ei++){for(Q=0,$=F;$>=oi;$--)Q+=G[$]*W[$][ei];for(Q=Q/Z,$=oi;$<=F;$++)W[$][ei]-=Q*G[$]}for($=0;$<=F;$++){for(Q=0,ei=F;ei>=oi;ei--)Q+=G[ei]*W[$][ei];for(Q=Q/Z,ei=oi;ei<=F;ei++)W[$][ei]-=Q*G[ei]}G[oi]=ti*G[oi],W[oi][oi-1]=ti*K}}for($=0;$<O;$++)for(ei=0;ei<O;ei++)T[$][ei]=$===ei?1:0;for(oi=F-1;oi>=E+1;oi--)if(0!==W[oi][oi-1]){for($=oi+1;$<=F;$++)G[$]=W[$][oi-1];for(ei=oi;ei<=F;ei++){for(K=0,$=oi;$<=F;$++)K+=G[$]*T[$][ei];for(K=K/G[oi]/W[oi][oi-1],$=oi;$<=F;$++)T[$][ei]+=K*G[$]}}}function D(O,W,G,T,E){var ai,mi,ui,di,pi,ci,ji,hi,wi,gi,ki,bi,fi,zi,Mi,F=O-1,Q=0,K=O-1,Z=Math.pow(2,-52),$=0,ei=0,oi=0,ti=0,ni=0,si=0,ri=0,li=0;for(ai=0;ai<O;ai++)for((ai<Q||ai>K)&&(G[ai]=E[ai][ai],W[ai]=0),mi=Math.max(ai-1,0);mi<O;mi++)ei=ei+Math.abs(E[ai][mi]);for(;F>=Q;){for(di=F;di>Q&&(si=Math.abs(E[di-1][di-1])+Math.abs(E[di][di]),0==si&&(si=ei),!(Math.abs(E[di][di-1])<Z*si));)di--;if(di===F)E[F][F]=E[F][F]+$,G[F]=E[F][F],W[F]=0,F--,li=0;else if(di===F-1){if(ji=E[F][F-1]*E[F-1][F],oi=(E[F-1][F-1]-E[F][F])/2,ti=oi*oi+ji,ri=Math.sqrt(Math.abs(ti)),E[F][F]=E[F][F]+$,E[F-1][F-1]=E[F-1][F-1]+$,hi=E[F][F],0<=ti){for(ri=0<=oi?oi+ri:oi-ri,G[F-1]=hi+ri,G[F]=G[F-1],0!=ri&&(G[F]=hi-ji/ri),W[F-1]=0,W[F]=0,hi=E[F][F-1],si=Math.abs(hi)+Math.abs(ri),oi=hi/si,ti=ri/si,ni=Math.sqrt(oi*oi+ti*ti),oi=oi/ni,ti=ti/ni,mi=F-1;mi<O;mi++)ri=E[F-1][mi],E[F-1][mi]=ti*ri+oi*E[F][mi],E[F][mi]=ti*E[F][mi]-oi*ri;for(ai=0;ai<=F;ai++)ri=E[ai][F-1],E[ai][F-1]=ti*ri+oi*E[ai][F],E[ai][F]=ti*E[ai][F]-oi*ri;for(ai=Q;ai<=K;ai++)ri=T[ai][F-1],T[ai][F-1]=ti*ri+oi*T[ai][F],T[ai][F]=ti*T[ai][F]-oi*ri}else G[F-1]=hi+oi,G[F]=hi+oi,W[F-1]=ri,W[F]=-ri;F=F-2,li=0}else{if(hi=E[F][F],wi=0,ji=0,di<F&&(wi=E[F-1][F-1],ji=E[F][F-1]*E[F-1][F]),10==li){for($+=hi,ai=Q;ai<=F;ai++)E[ai][ai]-=hi;si=Math.abs(E[F][F-1])+Math.abs(E[F-1][F-2]),hi=wi=0.75*si,ji=-0.4375*si*si}if(30==li&&(si=(wi-hi)/2,si=si*si+ji,0<si)){for(si=Math.sqrt(si),wi<hi&&(si=-si),si=hi-ji/((wi-hi)/2+si),ai=Q;ai<=F;ai++)E[ai][ai]-=si;$+=si,hi=wi=ji=0.964}for(li=li+1,pi=F-2;pi>=di&&(ri=E[pi][pi],ni=hi-ri,si=wi-ri,oi=(ni*si-ji)/E[pi+1][pi]+E[pi][pi+1],ti=E[pi+1][pi+1]-ri-ni-si,ni=E[pi+2][pi+1],si=Math.abs(oi)+Math.abs(ti)+Math.abs(ni),oi=oi/si,ti=ti/si,ni=ni/si,pi!=di)&&!(Math.abs(E[pi][pi-1])*(Math.abs(ti)+Math.abs(ni))<Z*(Math.abs(oi)*(Math.abs(E[pi-1][pi-1])+Math.abs(ri)+Math.abs(E[pi+1][pi+1]))));)pi--;for(ai=pi+2;ai<=F;ai++)E[ai][ai-2]=0,ai>pi+2&&(E[ai][ai-3]=0);for(ui=pi;ui<=F-1&&(zi=ui!==F-1,ui!=pi&&(oi=E[ui][ui-1],ti=E[ui+1][ui-1],ni=zi?E[ui+2][ui-1]:0,hi=Math.abs(oi)+Math.abs(ti)+Math.abs(ni),0!==hi&&(oi=oi/hi,ti=ti/hi,ni=ni/hi)),0!==hi);ui++)if(si=Math.sqrt(oi*oi+ti*ti+ni*ni),0>oi&&(si=-si),0!==si){for(ui==pi?di!==pi&&(E[ui][ui-1]=-E[ui][ui-1]):E[ui][ui-1]=-si*hi,oi=oi+si,hi=oi/si,wi=ti/si,ri=ni/si,ti=ti/oi,ni=ni/oi,mi=ui;mi<O;mi++)oi=E[ui][mi]+ti*E[ui+1][mi],zi&&(oi=oi+ni*E[ui+2][mi],E[ui+2][mi]=E[ui+2][mi]-oi*ri),E[ui][mi]=E[ui][mi]-oi*hi,E[ui+1][mi]=E[ui+1][mi]-oi*wi;for(ai=0;ai<=Math.min(F,ui+3);ai++)oi=hi*E[ai][ui]+wi*E[ai][ui+1],zi&&(oi=oi+ri*E[ai][ui+2],E[ai][ui+2]=E[ai][ui+2]-oi*ni),E[ai][ui]=E[ai][ui]-oi,E[ai][ui+1]=E[ai][ui+1]-oi*ti;for(ai=Q;ai<=K;ai++)oi=hi*T[ai][ui]+wi*T[ai][ui+1],zi&&(oi=oi+ri*T[ai][ui+2],T[ai][ui+2]=T[ai][ui+2]-oi*ni),T[ai][ui]=T[ai][ui]-oi,T[ai][ui+1]=T[ai][ui+1]-oi*ti}}}if(0!==ei){for(F=O-1;0<=F;F--)if(oi=G[F],ti=W[F],0===ti)for(di=F,E[F][F]=1,ai=F-1;0<=ai;ai--){for(ji=E[ai][ai]-oi,ni=0,mi=di;mi<=F;mi++)ni=ni+E[ai][mi]*E[mi][F];if(0>W[ai])ri=ji,si=ni;else if(di=ai,0===W[ai]?E[ai][F]=0===ji?-ni/(Z*ei):-ni/ji:(hi=E[ai][ai+1],wi=E[ai+1][ai],ti=(G[ai]-oi)*(G[ai]-oi)+W[ai]*W[ai],ci=(hi*si-ri*ni)/ti,E[ai][F]=ci,E[ai+1][F]=Math.abs(hi)>Math.abs(ri)?(-ni-ji*ci)/hi:(-si-wi*ci)/ri),ci=Math.abs(E[ai][F]),1<Z*ci*ci)for(mi=ai;mi<=F;mi++)E[mi][F]=E[mi][F]/ci}else if(0>ti)for(di=F-1,Math.abs(E[F][F-1])>Math.abs(E[F-1][F])?(E[F-1][F-1]=ti/E[F][F-1],E[F-1][F]=-(E[F][F]-oi)/E[F][F-1]):(Mi=_(0,-E[F-1][F],E[F-1][F-1]-oi,ti),E[F-1][F-1]=Mi[0],E[F-1][F]=Mi[1]),E[F][F-1]=0,E[F][F]=1,ai=F-2;0<=ai;ai--){for(gi=0,ki=0,mi=di;mi<=F;mi++)gi=gi+E[ai][mi]*E[mi][F-1],ki=ki+E[ai][mi]*E[mi][F];if(ji=E[ai][ai]-oi,0>W[ai])ri=ji,ni=gi,si=ki;else if(di=ai,0===W[ai]?(Mi=_(-gi,-ki,ji,ti),E[ai][F-1]=Mi[0],E[ai][F]=Mi[1]):(hi=E[ai][ai+1],wi=E[ai+1][ai],bi=(G[ai]-oi)*(G[ai]-oi)+W[ai]*W[ai]-ti*ti,fi=2*(G[ai]-oi)*ti,0===bi&&0===fi&&(bi=Z*ei*(Math.abs(ji)+Math.abs(ti)+Math.abs(hi)+Math.abs(wi)+Math.abs(ri))),Mi=_(hi*ni-ri*gi+ti*ki,hi*si-ri*ki-ti*gi,bi,fi),E[ai][F-1]=Mi[0],E[ai][F]=Mi[1],Math.abs(hi)>Math.abs(ri)+Math.abs(ti)?(E[ai+1][F-1]=(-gi-ji*E[ai][F-1]+ti*E[ai][F])/hi,E[ai+1][F]=(-ki-ji*E[ai][F]-ti*E[ai][F-1])/hi):(Mi=_(-ni-wi*E[ai][F-1],-si-wi*E[ai][F],ri,ti),E[ai+1][F-1]=Mi[0],E[ai+1][F]=Mi[1])),ci=Math.max(Math.abs(E[ai][F-1]),Math.abs(E[ai][F])),1<Z*ci*ci)for(mi=ai;mi<=F;mi++)E[mi][F-1]=E[mi][F-1]/ci,E[mi][F]=E[mi][F]/ci}for(ai=0;ai<O;ai++)if(ai<Q||ai>K)for(mi=ai;mi<O;mi++)T[ai][mi]=E[ai][mi];for(mi=O-1;mi>=Q;mi--)for(ai=Q;ai<=K;ai++){for(ri=0,ui=Q;ui<=Math.min(mi,K);ui++)ri=ri+T[ai][ui]*E[ui][mi];T[ai][mi]=ri}}}function _(O,W,G,T){var E,F;return Math.abs(G)>Math.abs(T)?(E=T/G,F=G+E*T,[(O+E*W)/F,(W-E*O)/F]):(E=G/T,F=T+E*G,[(E*O+W)/F,(E*W-O)/F])}var L=M(6),P=M(9).hypotenuse;S.prototype={get realEigenvalues(){return this.d},get imaginaryEigenvalues(){return this.e},get eigenvectorMatrix(){return this.V},get diagonalMatrix(){var E,F,O=this.n,W=this.e,G=this.d,T=new L(O,O);for(E=0;E<O;E++){for(F=0;F<O;F++)T[E][F]=0;T[E][E]=G[E],0<W[E]?T[E][E+1]=W[E]:0>W[E]&&(T[E][E-1]=W[E])}return T}},o.exports=S},function(o,u,M){'use strict';function S(R){if(!(this instanceof S))return new S(R);R=I.checkMatrix(R);var O,W,G,T,E,F,Q,K,Z,$,C=R.clone(),D=C.rows,_=C.columns,L=Array(D),P=1;for(O=0;O<D;O++)L[O]=O;for(Z=Array(D),W=0;W<_;W++){for(O=0;O<D;O++)Z[O]=C[O][W];for(O=0;O<D;O++){for(K=C[O],$=Math.min(O,W),E=0,G=0;G<$;G++)E+=K[G]*Z[G];K[W]=Z[O]-=E}for(T=W,O=W+1;O<D;O++)Math.abs(Z[O])>Math.abs(Z[T])&&(T=O);if(T!==W){for(G=0;G<_;G++)F=C[T][G],C[T][G]=C[W][G],C[W][G]=F;Q=L[T],L[T]=L[W],L[W]=Q,P=-P}if(W<D&&0!==C[W][W])for(O=W+1;O<D;O++)C[O][W]/=C[W][W]}this.LU=C,this.pivotVector=L,this.pivotSign=P}var I=M(6);S.prototype={isSingular:function(){var R=this.LU,C=R.columns;for(var D=0;D<C;D++)if(0===R[D][D])return!0;return!1},get determinant(){var R=this.LU;if(!R.isSquare())throw new Error('Matrix must be square');var C=this.pivotSign,D=R.columns;for(var _=0;_<D;_++)C*=R[_][_];return C},get lowerTriangularFactor(){var R=this.LU,C=R.rows,D=R.columns,_=new I(C,D);for(var L=0;L<C;L++)for(var P=0;P<D;P++)_[L][P]=L>P?R[L][P]:L===P?1:0;return _},get upperTriangularFactor(){var R=this.LU,C=R.rows,D=R.columns,_=new I(C,D);for(var L=0;L<C;L++)for(var P=0;P<D;P++)_[L][P]=L<=P?R[L][P]:0;return _},get pivotPermutationVector(){return this.pivotVector.slice()},solve:function(R){R=I.checkMatrix(R);var C=this.LU,D=C.rows;if(D!==R.rows)throw new Error('Invalid matrix dimensions');if(this.isSingular())throw new Error('LU matrix is singular');var O,W,G,_=R.columns,L=R.subMatrixRow(this.pivotVector,0,_-1),P=C.columns;for(G=0;G<P;G++)for(O=G+1;O<P;O++)for(W=0;W<_;W++)L[O][W]-=L[G][W]*C[O][G];for(G=P-1;0<=G;G--){for(W=0;W<_;W++)L[G][W]/=C[G][G];for(O=0;O<G;O++)for(W=0;W<_;W++)L[O][W]-=L[G][W]*C[O][G]}return L}},o.exports=S},function(o,u,M){'use strict';function S(C){if(!(this instanceof S))return new S(C);C=I.checkMatrix(C);var O,W,G,T,D=C.clone(),_=C.rows,L=C.columns,P=Array(L);for(G=0;G<L;G++){var E=0;for(O=G;O<_;O++)E=R(E,D[O][G]);if(0!==E){for(0>D[G][G]&&(E=-E),O=G;O<_;O++)D[O][G]/=E;for(D[G][G]+=1,W=G+1;W<L;W++){for(T=0,O=G;O<_;O++)T+=D[O][G]*D[O][W];for(T=-T/D[G][G],O=G;O<_;O++)D[O][W]+=T*D[O][G]}}P[G]=-E}this.QR=D,this.Rdiag=P}var I=M(6),R=M(9).hypotenuse;S.prototype={solve:function(C){C=I.checkMatrix(C);var D=this.QR,_=D.rows;if(C.rows!==_)throw new Error('Matrix row dimensions must agree');if(!this.isFullRank())throw new Error('Matrix is rank deficient');var W,G,T,E,L=C.columns,P=C.clone(),O=D.columns;for(T=0;T<O;T++)for(G=0;G<L;G++){for(E=0,W=T;W<_;W++)E+=D[W][T]*P[W][G];for(E=-E/D[T][T],W=T;W<_;W++)P[W][G]+=E*D[W][T]}for(T=O-1;0<=T;T--){for(G=0;G<L;G++)P[T][G]/=this.Rdiag[T];for(W=0;W<T;W++)for(G=0;G<L;G++)P[W][G]-=P[T][G]*D[W][T]}return P.subMatrix(0,O-1,0,L-1)},isFullRank:function(){var C=this.QR.columns;for(var D=0;D<C;D++)if(0===this.Rdiag[D])return!1;return!0},get upperTriangularFactor(){var L,P,C=this.QR,D=C.columns,_=new I(D,D);for(L=0;L<D;L++)for(P=0;P<D;P++)_[L][P]=L<P?C[L][P]:L===P?this.Rdiag[L]:0;return _},get orthogonalFactor(){var P,O,W,G,C=this.QR,D=C.rows,_=C.columns,L=new I(D,_);for(W=_-1;0<=W;W--){for(P=0;P<D;P++)L[P][W]=0;for(L[W][W]=1,O=W;O<_;O++)if(0!==C[W][W]){for(G=0,P=W;P<D;P++)G+=C[P][W]*L[P][O];for(G=-G/C[W][W],P=W;P<D;P++)L[P][O]+=G*C[P][W]}}return L}},o.exports=S},function(o,u,M){'use strict';function S(R){if(!(this instanceof S))return new S(R);if(R=I.checkMatrix(R),!R.isSymmetric())throw new Error('Matrix is not symmetric');var P,O,W,C=R,D=C.rows,_=new I(D,D),L=!0;for(O=0;O<D;O++){var G=_[O],T=0;for(W=0;W<O;W++){var E=_[W],F=0;for(P=0;P<W;P++)F+=E[P]*G[P];G[W]=F=(C[O][W]-F)/_[W][W],T=T+F*F}for(T=C[O][O]-T,L&=0<T,_[O][O]=Math.sqrt(Math.max(T,0)),W=O+1;W<D;W++)_[O][W]=0}if(!L)throw new Error('Matrix is not positive definite');this.L=_}var I=M(6);S.prototype={get leftTriangularFactor(){return this.L},solve:function(R){R=I.checkMatrix(R);var C=this.L,D=C.rows;if(R.rows!==D)throw new Error('Matrix dimensions do not match');var P,O,W,_=R.columns,L=R.clone();for(W=0;W<D;W++)for(O=0;O<_;O++){for(P=0;P<W;P++)L[W][O]-=L[P][O]*C[W][P];L[W][O]/=C[W][W]}for(W=D-1;0<=W;W--)for(O=0;O<_;O++){for(P=W+1;P<D;P++)L[W][O]-=L[P][O]*C[P][W];L[W][O]/=C[W][W]}return L}},o.exports=S},function(o,u,M){'use strict';var S=M(5);o.exports={transpose:function(R){if('number'==typeof R)return R;var C=R.clone();return C.transpose()},add:function(R,C){if('number'==typeof R&&'number'==typeof C)return R+C;if('number'==typeof R)return this.add(C,R);var D=R.clone();return D.add(C)},subtract:function(R,C){if('number'==typeof R&&'number'==typeof C)return R-C;if('number'==typeof R)return this.subtract(C,R);var D=R.clone();return D.sub(C)},multiply:function(R,C){if('number'==typeof R&&'number'==typeof C)return R*C;if('number'==typeof R)return this.multiply(C,R);var D=R.clone();return'number'==typeof C?D.mul(C):D=D.mmul(C),1==D.rows&&1==D.columns?D[0][0]:D},dotMultiply:function(R,C){var D=R.clone();return D.mul(C)},dotDivide:function(R,C){var D=R.clone();return D.div(C)},diag:function(R){var I=null,C=R.rows,D=R.columns,_,L;if('undefined'==typeof D&&'object'==typeof R)if(R[0]&&R[0].length)for(C=R.length,D=R[0].length,L=Math.min(C,D),I=S.zeros(D,D),_=0;_<D;_++)I[_][_]=R[_][_];else for(D=R.length,I=S.zeros(D,D),_=0;_<D;_++)I[_][_]=R[_];if(1==C)for(I=S.zeros(D,D),_=0;_<D;_++)I[_][_]=R[0][_];else if(0<C&&0<D)for(L=Math.min(C,D),I=Array(L),_=0;_<L;_++)I[_]=R[_][_];return I},min:function(R,C){if('number'==typeof R&&'number'==typeof C)return Math.min(R,C);var D=R.rows,_=R.columns,L=new S(D,_);for(var P=0;P<D;P++)for(var O=0;O<_;O++)L[P][O]=R[P][O]<C[P][O]?R[P][O]:C[P][O];return L},max:function(R,C){if('number'==typeof R&&'number'==typeof C)return Math.max(R,C);var D=R.rows,_=R.columns,L=new S(D,_);for(var P=0;P<D;P++)for(var O=0;O<_;O++)L[P][O]=R[P][O]>C[P][O]?R[P][O]:C[P][O];return L},solve:function(R,C){return R.solve(C)},inv:function(R){return'number'==typeof R?1/R:R.inverse()},sqrt:function(R){if('number'==typeof R)return Math.sqrt(R);var C=R.rows,D=R.columns,_=new S(C,D);for(var L=0;L<C;L++)for(var P=0;P<D;P++)_[L][P]=Math.sqrt(R[L][P]);return _},exp:function(R){if('number'==typeof R)return Math.sqrt(R);var C=R.rows,D=R.columns,_=new S(C,D);for(var L=0;L<C;L++)for(var P=0;P<D;P++)_[L][P]=Math.exp(R[L][P]);return _},dotPow:function(R,C){if('number'==typeof R)return Math.pow(R,C);var D=R.rows,_=R.columns,L=new S(D,_);for(var P=0;P<D;P++)for(var O=0;O<_;O++)L[P][O]=Math.pow(R[P][O],C);return L},abs:function(R){if('number'==typeof R)return Math.abs(R);var C=R.rows,D=R.columns,_=new S(C,D);for(var L=0;L<C;L++)for(var P=0;P<D;P++)_[L][P]=Math.abs(R[L][P]);return _},matrix:function(R,C){return new S(R,C)},ones:function(R,C){return S.ones(R,C)},zeros:function(R,C){return S.zeros(R,C)},random:function(R,C){return S.rand(R,C)},eye:function(R,C){return S.eye(R,C)}}},function(o,u,M){'use strict';function S(_){var L=0,P=0,O=_.length;for(let G=0;G<O;++G)L+=_[G];L/=O;var W=Array(O);for(let G=0;G<O;++G)W[G]=Math.abs(_[G]-L);return W.sort(),P=1==O%2?W[(O-1)/2]/0.6745:0.5*(W[O/2]+W[O/2-1])/0.6745,P}function I(_,L,P){var O,W,G,T,E;for(var F=0;F<_.length;F++)E=_[F].i,P[E-1]>=P[E-2]&&P[E-1]>=P[E]?E--:P[E+1]>=P[E]&&P[E+1]>=P[E+2]?E++:P[E-2]>=P[E-3]&&P[E-2]>=P[E-1]?E-=2:P[E+2]>=P[E+1]&&P[E+2]>=P[E+3]&&(E+=2),0<P[E-1]&&0<P[E+1]&&P[E]>=P[E-1]&&P[E]>=P[E+1]&&(O=20*Math.log10(P[E-1]),W=20*Math.log10(P[E]),G=20*Math.log10(P[E+1]),T=0.5*(O-G)/(O-2*W+G),_[F].x=L[E]+(L[E]-L[E-1])*T,_[F].y=P[E]-0.25*(P[E-1]-P[E+1])*T)}const R=M(16),C=M(17),D={sgOptions:{windowSize:9,polynomial:3},minMaxRatio:0.00025,broadRatio:0,maxCriteria:!0,smoothY:!0,realTopDetection:!1,heightFactor:0,boundaries:!1,derivativeThreshold:-1};o.exports=function(L,P,O){O=R({},D,O);let W=O.sgOptions;const G=[].concat(P);if(!('noiseLevel'in O)){var F,T=0,E=Number.MAX_VALUE;for(let Si=0;Si<L.length-1;++Si)F=Math.abs(L[Si+1]-L[Si]),F<E&&(E=F),F>T&&(T=F);O.noiseLevel=0.05>(T-E)/T?S(G):0}const Q={m:1,b:O.noiseLevel};O.maxCriteria||(Q.m=-1,Q.b*=-1);for(let Si=0;Si<G.length;Si++)G[Si]=Q.m*G[Si]-Q.b;for(let Si=0;Si<G.length;Si++)0>G[Si]&&(G[Si]=0);let Z,$,K=G;0.05>(T-E)/T?(O.smoothY&&(K=C(G,L[1]-L[0],{windowSize:W.windowSize,polynomial:W.polynomial,derivative:0})),Z=C(G,L[1]-L[0],{windowSize:W.windowSize,polynomial:W.polynomial,derivative:1}),$=C(G,L[1]-L[0],{windowSize:W.windowSize,polynomial:W.polynomial,derivative:2})):(O.smoothY&&(K=C(G,L,{windowSize:W.windowSize,polynomial:W.polynomial,derivative:0})),Z=C(G,L,{windowSize:W.windowSize,polynomial:W.polynomial,derivative:1}),$=C(G,L,{windowSize:W.windowSize,polynomial:W.polynomial,derivative:2}));const ei=L,oi=L[1]-L[0];var ti=0,ni=0;for(let Si=0;Si<K.length;Si++)Math.abs($[Si])>ti&&(ti=Math.abs($[Si])),Math.abs(K[Si])>ni&&(ni=Math.abs(K[Si]));var si=null,ri=null,li=Array(K.length-2),ai=Array(K.length),mi=Array(K.length),ui=Array(K.length-2),di=0,pi=0,ci=0,ji=0;for(let Si=1;Si<K.length-1;++Si)Math.abs(Z[Si])>O.derivativeThreshold&&((Z[Si]<Z[Si-1]&&Z[Si]<=Z[Si+1]||Z[Si]<=Z[Si-1]&&Z[Si]<Z[Si+1])&&(ri={x:ei[Si],index:Si},0<oi&&null!=si&&(ai[pi++]=si,mi[ci++]=ri)),(Z[Si]>=Z[Si-1]&&Z[Si]>Z[Si+1]||Z[Si]>Z[Si-1]&&Z[Si]>=Z[Si+1])&&(si={x:ei[Si],index:Si},0>oi&&null!=ri&&(ai[pi++]=si,mi[ci++]=ri))),$[Si]<$[Si-1]&&$[Si]<$[Si+1]&&(li[di++]=Si,ui[ji++]=Math.abs($[Si])<=O.broadRatio*ti);li.length=di,ai.length=pi,mi.length=ci,ui.length=ji;let ki,bi,fi,zi,Mi,hi=Array(li.length),wi=0,gi=-1;for(let Si=0;Si<li.length;++Si){bi=ei[li[Si]],ki=-1;let Ii=gi+1;for(zi=Number.MAX_VALUE,fi=0,Mi=!0;-1===ki&&Ii<ai.length&&Mi;)fi=Math.abs(bi-(ai[Ii].x+mi[Ii].x)/2),fi<zi?zi=fi:Mi=!1,fi<Math.abs(ai[Ii].x-mi[Ii].x)/2&&(ki=Ii,gi=Ii),++Ii;if(-1!==ki&&Math.abs(K[li[Si]])>O.minMaxRatio*ni&&(hi[wi++]={index:li[Si],x:bi,y:(K[li[Si]]+Q.b)/Q.m,width:Math.abs(mi[ki].x-ai[ki].x),soft:ui[Si]},O.boundaries&&(hi[wi-1].left=ai[ki],hi[wi-1].right=mi[ki]),O.heightFactor)){let Ri=K[ai[ki].index],Vi=K[mi[ki].index];hi[wi-1].height=O.heightFactor*(hi[wi-1].y-(Ri+Vi)/2)}}hi.length=wi,O.realTopDetection&&I(hi,ei,K);for(let Si=0;Si<hi.length;Si++)hi[Si].base=O.noiseLevel;return hi.sort(function(Si,Ii){return Si.x-Ii.x}),hi}},function(o,u){'use strict';var M=Object.prototype.hasOwnProperty,S=Object.prototype.toString,I=function(D){return'function'==typeof Array.isArray?Array.isArray(D):'[object Array]'===S.call(D)},R=function(D){if(!D||'[object Object]'!==S.call(D))return!1;var _=M.call(D,'constructor'),L=D.constructor&&D.constructor.prototype&&M.call(D.constructor.prototype,'isPrototypeOf');if(D.constructor&&!_&&!L)return!1;for(var P in D);return'undefined'==typeof P||M.call(D,P)};o.exports=function C(){var D,_,L,P,O,W,G=arguments[0],T=1,E=arguments.length,F=!1;for('boolean'==typeof G?(F=G,G=arguments[1]||{},T=2):('object'!=typeof G&&'function'!=typeof G||null==G)&&(G={});T<E;++T)if(D=arguments[T],null!=D)for(_ in D)L=G[_],P=D[_],G!==P&&(F&&P&&(R(P)||(O=I(P)))?(O?(O=!1,W=L&&I(L)?L:[]):W=L&&R(L)?L:{},G[_]=C(F,W,P)):'undefined'!=typeof P&&(G[_]=P));return G}},function(o,u,M){function S(P,O,W,G){var T=0,E=0;for(var F=O-W;F<O+W;F++)0<=F&&F<P.length-1&&(T+=P[F+1]-P[F],E++);return Math.pow(T/E,G)}function I(P,O,W,G){var T=0;return T=0<W?(4*W-2)/(W*(2*O-W+1))*(P*I(P,O,W-1,G)+G*I(P,O,W-1,G-1))-(W-1)*(2*O+W)/(W*(2*O-W+1))*I(P,O,W-2,G):0==W&&0==G?1:0,T}function R(P,O){var W=1;if(P>=O)for(var G=P-O+1;G<=P;G++)W*=G;return W}function C(P,O,W,G,T){var E=0;for(var F=0;F<=G;F++)E+=(2*F+1)*(R(2*W,F)/R(2*W+F+1,F+1))*I(P,W,F,0)*I(O,W,F,T);return E}function D(P,O,W){var G=Array(P),T=Math.floor(P/2);for(var E=-T;E<=T;E++){G[E+T]=Array(P);for(var F=-T;F<=T;F++)G[E+T][F+T]=C(F,E,T,O,W)}return G}var _=M(16);M(18);var L={windowSize:9,derivative:0,polynomial:3};o.exports=function(O,W,G){if(G=_({},L,G),0==G.windowSize%2||5>G.windowSize||!Number.isInteger(G.windowSize))throw new RangeError('Invalid window size (should be odd and at least 5 integer number)');if(G.windowSize>O.length)throw new RangeError('Window size is higher than the data length '+G.windowSize+'>'+O.length);if(0>G.derivative||!Number.isInteger(G.derivative))throw new RangeError('Derivative should be a positive integer');if(1>G.polynomial||!Number.isInteger(G.polynomial))throw new RangeError('Polynomial should be a positive integer');6<=G.polynomial&&console.warn('You should not use polynomial grade higher than 5 if you are not sure that your data arises from such a model. Possible polynomial oscillation problems');var T=G.windowSize,E=Math.floor(T/2),F=O.length,Q=Array(F),K=D(T,G.polynomial,G.derivative),Z=0,$=!0;'[object Array]'===Object.prototype.toString.call(W)?$=!1:Z=Math.pow(W,G.derivative);for(var ei=0;ei<E;ei++){var oi=K[E-ei-1],ti=K[E+ei+1],ni=0,si=0;for(var ri=0;ri<T;ri++)ni+=oi[ri]*O[ri],si+=ti[ri]*O[F-T+ri-1];$?(Q[E-ei-1]=ni/Z,Q[F-E+ei]=si/Z):(Z=S(W,E-ei-1,E,G.derivative),Q[E-ei-1]=ni/Z,Z=S(W,F-E+ei,E,G.derivative),Q[F-E+ei]=si/Z)}var li=K[E];for(var ei=T;ei<F+1;ei++){var ai=0;for(var ri=0;ri<T;ri++)ai+=li[ri]*O[ri+ei-T];$||(Z=S(W,ei-E-1,E,G.derivative)),Q[ei-E-1]=ai/Z}return Q}},function(o,u,M){'use strict';u.array=M(19),u.matrix=M(20)},function(o,u){'use strict';function M(S,I){return S-I}u.sum=function(I){var S=0;for(var R=0;R<I.length;R++)S+=I[R];return S},u.max=function(I){var S=-(1/0),R=I.length;for(var C=0;C<R;C++)I[C]>S&&(S=I[C]);return S},u.min=function(I){var S=1/0,R=I.length;for(var C=0;C<R;C++)I[C]<S&&(S=I[C]);return S},u.minMax=function(I){var R=1/0,C=-(1/0),D=I.length;for(var _=0;_<D;_++)I[_]<R&&(R=I[_]),I[_]>C&&(C=I[_]);return{min:R,max:C}},u.arithmeticMean=function(I){var R=0,C=I.length;for(var D=0;D<C;D++)R+=I[D];return R/C},u.mean=u.arithmeticMean,u.geometricMean=function(I){var R=1,C=I.length;for(var D=0;D<C;D++)R*=I[D];return Math.pow(R,1/C)},u.logMean=function(I){var R=0,C=I.length;for(var D=0;D<C;D++)R+=Math.log(I[D]);return R/C},u.grandMean=function(I,R){var C=0,D=0,_=I.length;for(var L=0;L<_;L++)C+=R[L]*I[L],D+=R[L];return C/D},u.truncatedMean=function(I,R,C){C===void 0&&(C=!1),C||(I=I.slice().sort(M));var D=I.length,_=Math.floor(D*R),L=0;for(var P=_;P<D-_;P++)L+=I[P];return L/(D-2*_)},u.harmonicMean=function(I){var R=0,C=I.length;for(var D=0;D<C;D++){if(0===I[D])throw new RangeError('value at index '+D+'is zero');R+=1/I[D]}return C/R},u.contraHarmonicMean=function(I){var R=0,C=0,D=I.length;for(var _=0;_<D;_++)R+=I[_]*I[_],C+=I[_];if(0>C)throw new RangeError('sum of values is negative');return R/C},u.median=function(I,R){R===void 0&&(R=!1),R||(I=I.slice().sort(M));var C=I.length,D=Math.floor(C/2);return 0==C%2?0.5*(I[D-1]+I[D]):I[D]},u.variance=function(I,R){R===void 0&&(R=!0);var C=u.mean(I),D=0,_=I.length;for(var L=0;L<_;L++){var P=I[L]-C;D+=P*P}return R?D/(_-1):D/_},u.standardDeviation=function(I,R){return Math.sqrt(u.variance(I,R))},u.standardError=function(I){return u.standardDeviation(I)/Math.sqrt(I.length)},u.quartiles=function(I,R){'undefined'==typeof R&&(R=!1),R||(I=I.slice(),I.sort(M));var C=I.length/4,D=I[Math.ceil(C)-1],_=u.median(I,!0),L=I[Math.ceil(3*C)-1];return{q1:D,q2:_,q3:L}},u.pooledStandardDeviation=function(I,R){return Math.sqrt(u.pooledVariance(I,R))},u.pooledVariance=function(I,R){'undefined'==typeof R&&(R=!0);var C=0,D=0,_=I.length;for(var L=0;L<_;L++){var P=I[L],O=u.variance(P);C+=(P.length-1)*O,D+=R?P.length-1:P.length}return C/D},u.mode=function(I){var D,R=I.length,C=Array(R);for(D=0;D<R;D++)C[D]=0;var _=Array(R),L=0;for(D=0;D<R;D++){var P=_.indexOf(I[D]);0<=P?C[P]++:(_[L]=I[D],C[L]=1,L++)}var O=0,W=0;for(D=0;D<L;D++)C[D]>O&&(O=C[D],W=D);return _[W]},u.covariance=function(I,R,C){'undefined'==typeof C&&(C=!0);var D=u.mean(I),_=u.mean(R);if(I.length!==R.length)throw'Vectors do not have the same dimensions';var L=0,P=I.length;for(var O=0;O<P;O++){var W=I[O]-D,G=R[O]-_;L+=W*G}return C?L/(P-1):L/P},u.skewness=function(I,R){'undefined'==typeof R&&(R=!0);var C=u.mean(I),D=0,_=0,L=I.length;for(var P=0;P<L;P++){var O=I[P]-C;D+=O*O,_+=O*O*O}var W=D/L,G=_/L,T=G/Math.pow(W,3/2);if(R){var E=Math.sqrt(L*(L-1));return E/(L-2)*T}return T},u.kurtosis=function(I,R){'undefined'==typeof R&&(R=!0);var C=u.mean(I),D=I.length,_=0,L=0;for(var P=0;P<D;P++){var O=I[P]-C;_+=O*O,L+=O*O*O*O}var W=_/D,G=L/D;if(R){var T=_/(D-1),E=L/(T*T);return D*(D+1)/((D-1)*(D-2)*(D-3))*E-3*((D-1)*(D-1)/((D-2)*(D-3)))}return G/(W*W)-3},u.entropy=function(I,R){'undefined'==typeof R&&(R=0);var C=0,D=I.length;for(var _=0;_<D;_++)C+=I[_]*Math.log(I[_]+R);return-C},u.weightedMean=function(I,R){var C=0,D=I.length;for(var _=0;_<D;_++)C+=I[_]*R[_];return C},u.weightedStandardDeviation=function(I,R){return Math.sqrt(u.weightedVariance(I,R))},u.weightedVariance=function(I,R){var C=u.weightedMean(I,R),D=0,_=I.length,L=0,P=0;for(var O=0;O<_;O++){var W=I[O]-C,G=R[O];D+=G*(W*W),P+=G,L+=G*G}return D*(P/(P*P-L))},u.center=function(I,R){'undefined'==typeof R&&(R=!1);var C=I;R||(C=I.slice());var D=u.mean(C),_=C.length;for(var L=0;L<_;L++)C[L]-=D},u.standardize=function(I,R,C){'undefined'==typeof R&&(R=u.standardDeviation(I)),'undefined'==typeof C&&(C=!1);var D=I.length,_=C?I:Array(D);for(var L=0;L<D;L++)_[L]=I[L]/R;return _},u.cumulativeSum=function(I){var R=I.length,C=Array(R);C[0]=I[0];for(var D=1;D<R;D++)C[D]=C[D-1]+I[D];return C}},function(o,u,M){'use strict';function S(G,T){'undefined'==typeof T&&(T=0);var Q,K,Z,$,E=G.length,F=G[0].length;if(-1===T){for(Q=[0],K=E*F,Z=0;Z<E;Z++)for($=0;$<F;$++)Q[0]+=G[Z][$];Q[0]/=K}else if(0===T)for(Q=Array(F),K=E,$=0;$<F;$++){for(Q[$]=0,Z=0;Z<E;Z++)Q[$]+=G[Z][$];Q[$]/=K}else if(1===T)for(Q=Array(E),K=F,$=0;$<E;$++){for(Q[$]=0,Z=0;Z<F;Z++)Q[$]+=G[$][Z];Q[$]/=K}else throw new Error('Invalid dimension');return Q}function I(G,T,E){var F=R(G,T,E),Q=F.length;for(var K=0;K<Q;K++)F[K]=Math.sqrt(F[K]);return F}function R(G,T,E){'undefined'==typeof E&&(E=!0),T=T||S(G);var F=G.length;if(0===F)return[];var Q=G[0].length,K=Array(Q);for(var Z=0;Z<Q;Z++){var $=0,ei=0,oi=0;for(var ti=0;ti<F;ti++)oi=G[ti][Z]-T[Z],$+=oi,ei+=oi*oi;K[Z]=E?(ei-$*$/F)/(F-1):(ei-$*$/F)/F}return K}function C(G,T,E){'undefined'==typeof E&&(E=0),'undefined'==typeof T&&(0===E?T=G.length-1:1==E&&(T=G[0].length-1));var F=S(G,E),Q=G.length;if(0===Q)return[[]];var Z,$,ei,oi,ti,K=G[0].length;if(0===E){for(Z=Array(K),$=0;$<K;$++)Z[$]=Array(K);for($=0;$<K;$++)for(ei=$;ei<K;ei++){for(oi=0,ti=0;ti<Q;ti++)oi+=(G[ti][ei]-F[ei])*(G[ti][$]-F[$]);oi/=T,Z[$][ei]=oi,Z[ei][$]=oi}}else if(1===E){for(Z=Array(Q),$=0;$<Q;$++)Z[$]=Array(Q);for($=0;$<Q;$++)for(ei=$;ei<Q;ei++){for(oi=0,ti=0;ti<K;ti++)oi+=(G[ei][ti]-F[ei])*(G[$][ti]-F[$]);oi/=T,Z[$][ei]=oi,Z[ei][$]=oi}}else throw new Error('Invalid dimension');return Z}function D(G,T,E){return T=T||S(G),'undefined'==typeof E&&(E=I(G,!0,T)),L(_(G,T,!1),E,!0)}function _(G,T,E){T=T||S(G);var K,Z,$,F=G,Q=G.length;if(!E)for(F=Array(Q),K=0;K<Q;K++)F[K]=Array(G[K].length);for(K=0;K<Q;K++){var ei=F[K];for(Z=0,$=ei.length;Z<$;Z++)ei[Z]=G[K][Z]-T[Z]}return F}function L(G,T,E){'undefined'==typeof T&&(T=I(G));var K,Z,$,F=G,Q=G.length;if(!E)for(F=Array(Q),K=0;K<Q;K++)F[K]=Array(G[K].length);for(K=0;K<Q;K++){var ei=F[K],oi=G[K];for(Z=0,$=ei.length;Z<$;Z++)0===T[Z]||isNaN(T[Z])||(ei[Z]=oi[Z]/T[Z])}return F}function P(G,T,E){'undefined'==typeof E&&(E=0);var F=G.length;if(0===F)return[];var K,Z,$,ei,oi,ti,Q=G[0].length;if(0===E){for(K=Array(Q),Z=0;Z<Q;Z++)K[Z]=0;for(Z=0;Z<F;Z++)for(ti=G[Z],oi=T[Z],ei=0;ei<Q;ei++)K[ei]+=ti[ei]*oi}else if(1===E){for(K=Array(F),Z=0;Z<F;Z++)K[Z]=0;for(ei=0;ei<F;ei++)for(ti=G[ei],oi=T[ei],Z=0;Z<Q;Z++)K[ei]+=ti[Z]*oi}else throw new Error('Invalid dimension');var ni=W.sum(T);if(0!==ni)for(Z=0,$=K.length;Z<$;Z++)K[Z]/=ni;return K}function O(G,T,E,F,Q){Q=Q||0,E=E||P(G,T,Q),'undefined'==typeof F&&(F=1);var K=G.length;if(0===K)return[[]];var $,ei,oi,ti,ni,Z=G[0].length;if(0===Q){for($=Array(Z),ei=0;ei<Z;ei++)$[ei]=Array(Z);for(ei=0;ei<Z;ei++)for(oi=ei;oi<Z;oi++){for(ni=0,ti=0;ti<K;ti++)ni+=T[ti]*(G[ti][oi]-E[oi])*(G[ti][ei]-E[ei]);$[ei][oi]=ni*F,$[oi][ei]=ni*F}}else if(1===Q){for($=Array(K),ei=0;ei<K;ei++)$[ei]=Array(K);for(ei=0;ei<K;ei++)for(oi=ei;oi<K;oi++){for(ni=0,ti=0;ti<Z;ti++)ni+=T[ti]*(G[oi][ti]-E[oi])*(G[ei][ti]-E[ei]);$[ei][oi]=ni*F,$[oi][ei]=ni*F}}else throw new Error('Invalid dimension');return $}var W=M(19);o.exports={entropy:function(T,E){'undefined'==typeof E&&(E=0);var F=0,Q=T.length,K=T[0].length;for(var Z=0;Z<Q;Z++)for(var $=0;$<K;$++)F+=T[Z][$]*Math.log(T[Z][$]+E);return-F},mean:S,standardDeviation:I,variance:R,median:function(T){var E=T.length,F=T[0].length,Q=Array(F);for(var K=0;K<F;K++){var Z=Array(E);for(var $=0;$<E;$++)Z[$]=T[$][K];Z.sort();var ei=Z.length;Q[K]=0==ei%2?0.5*(Z[ei/2]+Z[ei/2-1]):Z[Math.floor(ei/2)]}return Q},mode:function(T){var K,Z,E=T.length,F=T[0].length,Q=Array(F);for(K=0;K<F;K++){var $=Array(E);for(var ei=0;ei<E;ei++)$[ei]=0;var oi=Array(E),ti=0;for(Z=0;Z<E;Z++){var ni=oi.indexOf(T[Z][K]);0<=ni?$[ni]++:(oi[ti]=T[Z][K],$[ti]=1,ti++)}var si=0,ri=0;for(Z=0;Z<ti;Z++)$[Z]>si&&(si=$[Z],ri=Z);Q[K]=oi[ri]}return Q},skewness:function(T,E){'undefined'==typeof E&&(E=!0);var F=S(T),Q=T.length,K=F.length,Z=Array(K);for(var $=0;$<K;$++){var ei=0,oi=0;for(var ti=0;ti<Q;ti++){var ni=T[ti][$]-F[$];ei+=ni*ni,oi+=ni*ni*ni}var si=ei/Q,ri=oi/Q,li=ri/Math.pow(si,3/2);if(E){var ai=Math.sqrt(Q*(Q-1));Z[$]=ai/(Q-2)*li}else Z[$]=li}return Z},kurtosis:function(T,E){'undefined'==typeof E&&(E=!0);var F=S(T),Q=T.length,K=T[0].length,Z=Array(K);for(var $=0;$<K;$++){var ei=0,oi=0;for(var ti=0;ti<Q;ti++){var ni=T[ti][$]-F[$];ei+=ni*ni,oi+=ni*ni*ni*ni}var si=ei/Q,ri=oi/Q;if(E){var li=ei/(Q-1),ai=oi/(li*li);Z[$]=Q*(Q+1)/((Q-1)*(Q-2)*(Q-3))*ai-3*((Q-1)*(Q-1)/((Q-2)*(Q-3)))}else Z[$]=ri/(si*si)-3}return Z},standardError:function(T){var E=T.length,F=I(T),Q=F.length,K=Array(Q),Z=Math.sqrt(E);for(var $=0;$<Q;$++)K[$]=F[$]/Z;return K},covariance:function(T,E){return C(T,void 0,E)},scatter:C,correlation:function(T){var $,ei,E=S(T),F=I(T,!0,E),Q=D(T,E,F),K=T.length,Z=T[0].length,oi=Array(Z);for($=0;$<Z;$++)oi[$]=Array(Z);for($=0;$<Z;$++)for(ei=$;ei<Z;ei++){var ti=0;for(var ni=0,si=Q.length;ni<si;ni++)ti+=Q[ni][ei]*Q[ni][$];ti/=K-1,oi[$][ei]=ti,oi[ei][$]=ti}return oi},zScores:D,center:_,standardize:L,weightedVariance:function(T,E){var F=S(T),Q=T.length;if(0===Q)return[];var K=T[0].length,Z=Array(K);for(var $=0;$<K;$++){var ei=0,oi=0,ti=0;for(var ni=0;ni<Q;ni++){var si=T[ni][$]-F[$],ri=E[ni];ei+=ri*(si*si),ti+=ri,oi+=ri*ri}Z[$]=ei*(ti/(ti*ti-oi))}return Z},weightedMean:P,weightedCovariance:function(T,E,F,Q){Q=Q||0,F=F||P(T,E,Q);var K=0,Z=0;for(var $=0,ei=E.length;$<ei;$++)K+=E[$],Z+=E[$]*E[$];var oi=K/(K*K-Z);return O(T,E,F,oi,Q)},weightedScatter:O}}])});;
//# sourceMappingURL=ml-gsd.min.js.map